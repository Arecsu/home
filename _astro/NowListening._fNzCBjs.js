import{S as L,o as z,a as B,s as b,b as M,c as h,U as v,g as E,d as w,e as U,f as H,h as K,i as Y,j as G,k as x,l as F,H as V,r as Z,m as p,n as R,p as S,q as T,t as D,u as J,E as Q,v as W,w as X,x as $,y as A,z as ee,A as k,B as O,C,D as j,F as te,G as re,I as ne}from"./render.BwMLRJU7.js";const ae="5";typeof window<"u"&&(window.__svelte||={v:new Set}).v.add(ae);function m(i,c=null,d){if(typeof i!="object"||i===null||L in i)return i;const g=K(i);if(g!==z&&g!==B)return i;var s=new Map,f=Y(i),o=b(0);f&&s.set("length",b(i.length));var u;return new Proxy(i,{defineProperty(a,e,t){(!("value"in t)||t.configurable===!1||t.enumerable===!1||t.writable===!1)&&M();var r=s.get(e);return r===void 0?(r=b(t.value),s.set(e,r)):h(r,m(t.value,u)),!0},deleteProperty(a,e){var t=s.get(e);if(t===void 0)e in a&&s.set(e,b(v));else{if(f&&typeof e=="string"){var r=s.get("length"),n=Number(e);Number.isInteger(n)&&n<r.v&&h(r,n)}h(t,v),q(o)}return!0},get(a,e,t){if(e===L)return i;var r=s.get(e),n=e in a;if(r===void 0&&(!n||E(a,e)?.writable)&&(r=b(m(n?a[e]:v,u)),s.set(e,r)),r!==void 0){var l=w(r);return l===v?void 0:l}return Reflect.get(a,e,t)},getOwnPropertyDescriptor(a,e){var t=Reflect.getOwnPropertyDescriptor(a,e);if(t&&"value"in t){var r=s.get(e);r&&(t.value=w(r))}else if(t===void 0){var n=s.get(e),l=n?.v;if(n!==void 0&&l!==v)return{enumerable:!0,configurable:!0,value:l,writable:!0}}return t},has(a,e){if(e===L)return!0;var t=s.get(e),r=t!==void 0&&t.v!==v||Reflect.has(a,e);if(t!==void 0||U!==null&&(!r||E(a,e)?.writable)){t===void 0&&(t=b(r?m(a[e],u):v),s.set(e,t));var n=w(t);if(n===v)return!1}return r},set(a,e,t,r){var n=s.get(e),l=e in a;if(f&&e==="length")for(var _=t;_<n.v;_+=1){var y=s.get(_+"");y!==void 0?h(y,v):_ in a&&(y=b(v),s.set(_+"",y))}n===void 0?(!l||E(a,e)?.writable)&&(n=b(void 0),h(n,m(t,u)),s.set(e,n)):(l=n.v!==v,h(n,m(t,u)));var N=Reflect.getOwnPropertyDescriptor(a,e);if(N?.set&&N.set.call(r,t),!l){if(f&&typeof e=="string"){var I=s.get("length"),P=Number(e);Number.isInteger(P)&&P>=I.v&&h(I,P+1)}q(o)}return!0},ownKeys(a){w(o);var e=Reflect.ownKeys(a).filter(n=>{var l=s.get(n);return l===void 0||l.v!==v});for(var[t,r]of s)r.v!==v&&!(t in a)&&e.push(t);return e},setPrototypeOf(){H()}})}function q(i,c=1){h(i,i.v+c)}function se(i,c,d,g=null,s=!1){x&&F();var f=i,o=null,u=null,a=null,e=s?Q:0;G(()=>{if(a===(a=!!c()))return;let t=!1;if(x){const r=f.data===V;a===r&&(f=Z(),p(f),R(!1),t=!0)}a?(o?S(o):o=T(()=>d(f)),u&&D(u,()=>{u=null})):(u?S(u):g&&(u=T(()=>g(f))),o&&D(o,()=>{o=null})),t&&R(!0)},e),x&&(f=J)}function ie(i,c,d,g,s){x&&F();var f=c.$$slots?.[d],o=!1;f===!0&&(f=c[d],o=!0),f===void 0||f(i,o?()=>g:g)}function fe(i,c,d){if(d){if(i.classList.contains(c))return;i.classList.add(c)}else{if(!i.classList.contains(c))return;i.classList.remove(c)}}var le=re('<div class="now-listening svelte-13br9z"><span class="listening-to">in my ears now â†™</span> <a class="no-underline disable-link-arrow svelte-13br9z" href="https://www.last.fm/user/Alejandro9R/" target="_blank"><!> </a></div>');function ce(i,c){W(c,!0);let d=k(null),g=k(!0),s=k(!1);async function f(){let e;try{e=await(await fetch("https://lastfm-a9r.martyr.workers.dev/")).text()}catch{throw console.error("Error fetching Now Listening data!"),Error("Error fetching Now Listening data!")}const r=new DOMParser().parseFromString(e,"text/html"),n=r.querySelector("tbody tr:first-child:has(.chartlist-now-scrobbling) .chartlist-name a")?.textContent,l=r.querySelector("tbody tr:first-child:has(.chartlist-now-scrobbling) .chartlist-artist a")?.textContent;if(!n||!l)return null;let _;if(n.includes("-")){const y=n.split("-").map(N=>N.trim());y[y.length-1].toLowerCase().includes("remaster")&&y.pop(),_=y.join(" - ")}else _=n;return{track:_,artist:l}}async function o(){try{const e=await f();e&&e!==w(d)&&h(d,m(e)),h(s,!!e)}catch(e){console.error(e)}finally{h(g,!1)}}o(),setInterval(o,1e4);var u=X(),a=$(u);se(a,()=>!w(g)&&w(d),e=>{var t=le(),r=O(C(t),2),n=C(r);ie(n,c,"icon",{});var l=O(n);j(r),j(t),te(()=>{fe(t,"is-playing",w(s)),ne(l,` ${w(d)?.artist??""} - ${w(d)?.track??""}`)}),A(e,t)}),A(i,u),ee()}export{ce as default};
