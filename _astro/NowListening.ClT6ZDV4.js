import{f as M,h as b,d as F,H as j,r as Q,s as B,i as P,j as k,k as x,p as C,b as H,E as V,l as z,n as y,o as v,q as _,v as I,w as N,x as G,y as J,z as K,A as w,t as Y,B as W,C as X,D as Z,F as ee,G as te,I as S,J as ne,K as T,L as D,M as R,N as se,O as re,P as ie}from"./render.yqEuM4O4.js";const ae="5";typeof window<"u"&&(window.__svelte||={v:new Set}).v.add(ae);function U(e){throw new Error("lifecycle_outside_component")}function le(e,s,t,n=null,i=!1){b&&F();var r=e,a=null,o=null,l=null,u=i?V:0;M(()=>{if(l===(l=!!s()))return;let h=!1;if(b){const m=r.data===j;l===m&&(r=Q(),B(r),P(!1),h=!0)}l?(a?k(a):a=x(()=>t(r)),o&&C(o,()=>{o=null})):(o?k(o):n&&(o=x(()=>n(r))),a&&C(a,()=>{a=null})),h&&P(!0)},u),b&&(r=H)}function oe(e,s,t,n,i){b&&F();var r=s.$$slots?.[t],a=!1;r===!0&&(r=s[t],a=!0),r===void 0||r(e,a?()=>n:n)}function ce(e,s,t){if(t){if(e.classList.contains(s))return;e.classList.add(s)}else{if(!e.classList.contains(s))return;e.classList.remove(s)}}function ue(e=!1){const s=v,t=s.l.u;if(!t)return;let n=()=>J(s.s);if(e){let i=0,r={};const a=K(()=>{let o=!1;const l=s.s;for(const u in l)l[u]!==r[u]&&(r[u]=l[u],o=!0);return o&&i++,i});n=()=>N(a)}t.b.length&&z(()=>{$(s,n),I(t.b)}),y(()=>{const i=_(()=>t.m.map(G));return()=>{for(const r of i)typeof r=="function"&&r()}}),t.a.length&&y(()=>{$(s,n),I(t.a)})}function $(e,s){if(e.l.s)for(const t of e.l.s)N(t);s()}function fe(e){v===null&&U(),v.l!==null?he(v).m.push(e):y(()=>{const s=_(e);if(typeof s=="function")return s})}function de(e){v===null&&U(),fe(()=>()=>_(e))}function he(e){var s=e.l;return s.u??={a:[],b:[],m:[]}}function ve(e,s,t){if(e==null)return s(void 0),w;const n=_(()=>e.subscribe(s,t));return n.unsubscribe?()=>n.unsubscribe():n}function A(e,s,t){const n=t[s]??={store:null,source:W(void 0),unsubscribe:w};if(n.store!==e)if(n.unsubscribe(),n.store=e??null,e==null)n.source.v=void 0,n.unsubscribe=w;else{var i=!0;n.unsubscribe=ve(e,r=>{i?n.source.v=r:X(n.source,r)}),i=!1}return N(n.source)}function pe(){const e={};return Y(()=>{for(var s in e)e[s].unsubscribe()}),e}let c=[],f=0;const p=4;let q=e=>{let s=[],t={get(){return t.lc||t.listen(()=>{})(),t.value},lc:0,listen(n){return t.lc=s.push(n),()=>{for(let r=f+p;r<c.length;)c[r]===n?c.splice(r,p):r+=p;let i=s.indexOf(n);~i&&(s.splice(i,1),--t.lc||t.off())}},notify(n,i){let r=!c.length;for(let a of s)c.push(a,t.value,n,i);if(r){for(f=0;f<c.length;f+=p)c[f](c[f+1],c[f+2],c[f+3]);c.length=0}},off(){},set(n){let i=t.value;i!==n&&(t.value=n,t.notify(i))},subscribe(n){let i=t.listen(n);return n(t.value),i},value:e};return t};const E=q(null),L=q(!1);let d;const be=e=>{if(e.includes("-")){const s=["remaster","remastered"],t=e.split("-").map(i=>i.trim());return s.some(i=>t[t.length-1].toLowerCase().includes(i))&&t.pop(),t.join(" - ")}else return e};async function ge(){let e;try{e=await(await fetch("https://lastfm-a9r.martyr.workers.dev/")).text()}catch{throw console.error("Error fetching Now Listening data!"),Error("Error fetching Now Listening data!")}const t=new DOMParser().parseFromString(e,"text/html"),n=t.querySelector("tbody tr:first-child:has(.chartlist-now-scrobbling) .chartlist-name a")?.textContent,i=t.querySelector("tbody tr:first-child:has(.chartlist-now-scrobbling) .chartlist-artist a")?.textContent;return!n||!i?null:{track:be(n),artist:i}}async function g(){if(document.hidden){clearInterval(d),d=null;return}try{const e=await ge();e&&e!==E.get()&&E.set(e),L.set(!!e)}catch(e){console.error(e)}}function _e(){g(),d=setInterval(g,10*1e3),document.addEventListener("visibilitychange",O)}function me(){d&&(clearInterval(d),d=null,document.removeEventListener("visibilitychange",O))}function O(){!document.hidden&&!d&&(g(),d=setInterval(g,10*1e3))}var ye=re('<div class="now-listening svelte-rdewev"><span class="listening-to">in my ears now â†™</span> <a class="no-underline disable-link-arrow svelte-rdewev" href="https://www.last.fm/user/Alejandro9R/" target="_blank"><!> </a></div>');function Ee(e,s){Z(s,!1);const t=pe(),n=()=>A(E,"$musicData",t),i=()=>A(L,"$isCurrentlyPlaying",t);_e(),de(()=>{me(),L.set(!1)}),ue();var r=ee(),a=te(r);le(a,n,o=>{var l=ye(),u=T(D(l),2),h=D(u);oe(h,s,"icon",{});var m=T(h);R(u),R(l),se(()=>{ce(l,"is-playing",i()),ie(m,` ${n()?.artist??""} - ${n()?.track??""}`)}),S(o,l)}),S(e,r),ne()}export{Ee as default};
